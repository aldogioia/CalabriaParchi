<section class="share-experience">
  <form [formGroup]="experienceForm" (ngSubmit)="share()">
    <article>
      <h2>{{ "SHARE_EXPERIENCE" | translate }}</h2>
      <p>{{ 'SHARE_EXPERIENCE_PARAGRAPH_1' | translate }}</p>
    </article>
    <div class="input-group" [class.error]="!selectedFile && experienceForm.touched">
      <label for="img">Foto</label>
      <div class="file-wrapper">
        <input id="img" name="img" type="file" accept="image/jpeg,image/png" (change)="onFileSelected($event)" required>
      </div>
      @if (!selectedFile && experienceForm.touched) {
        <span class="error-message">Immagine obbligatoria</span>
      }
    </div>

    <div class="input-group" [class.error]="isInvalid('email')">
      <label for="email">Email</label>
      <input name="email" type="email" placeholder="Email" formControlName="email" required>
      @if (isInvalid('email')) {
        <span class="error-message">{{ getErrorMessage('email') }}</span>
      }
    </div>

    <div class="input-group" [class.error]="isInvalid('park')">
      <label for="park">Parco</label>
      <select name="park" [class.color]="experienceForm.value.park === ''" formControlName="park" required>
        <option value="" disabled selected>Seleziona un Parco</option>
        @for (park of parks; track park) {
          <option [value]="park.id">{{ park.name }}</option>
        }
      </select>
      @if (isInvalid('park')) {
        <span class="error-message">{{ getErrorMessage('park') }}</span>
      }
    </div>

    <div class="input-group" [class.error]="isInvalid('description')">
      <label for="experience">La tua Esperienza</label>
      <textarea
        name="experience"
        minlength="3"
        maxlength="300"
        placeholder="Condividi la tua esperienza qui..."
        formControlName="description"
        required
      ></textarea>
      @if (isInvalid('description')) {
        <span class="error-message">{{ getErrorMessage('description') }}</span>
      }
    </div>

    <div class="input-group" [class.error]="isInvalid('name')">
      <label for="name">Nome</label>
      <input name="name" type="text" minlength="3" maxlength="20" placeholder="Nome" formControlName="name" required>
      @if (isInvalid('name')) {
        <span class="error-message">{{ getErrorMessage('name') }}</span>
      }
    </div>

    <div class="input-group" [class.error]="isInvalid('surname')">
      <label for="surname">Cognome</label>
      <input name="surname" type="text" minlength="3" maxlength="20" placeholder="Cognome" formControlName="surname" required>
      @if (isInvalid('surname')) {
        <span class="error-message">{{ getErrorMessage('surname') }}</span>
      }
    </div>

    <button
      class="primary-button"
      type="submit"
      [disabled]="experienceForm.invalid || !selectedFile">
      {{ "PUBLISH" | translate }}
    </button>
  </form>

  <figure class="preview">
    @if (selectedFileUrl !== null) {
      <img [src]="selectedFileUrl" alt="Anteprima Immagine">
    } @else {
      <span class="placeholder-image">
        Inserisci un'immagine
      </span>
    }
    <figcaption>
      <div class="location">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
          <path d="M10.223,18.035 C9.981,17.801 9.736,17.567 9.488,17.33 L9.459,17.303 C6.487,14.474 2.788,10.953 4.842,6.016 C6.027,3.165 8.904,1.25 12,1.25 C15.096,1.25 17.974,3.165 19.159,6.016 C21.22,10.972 17.49,14.509 14.493,17.351 C14.25,17.581 14.01,17.809 13.776,18.034 C13.296,18.496 12.666,18.75 12,18.75 L11.999,18.75 C11.333,18.75 10.703,18.496 10.223,18.035 Z M6.227,6.592 C4.569,10.577 7.581,13.444 10.493,16.216 L10.493,16.216 C10.755,16.465 11.013,16.711 11.265,16.955 C11.462,17.144 11.724,17.25 12,17.25 C12.276,17.25 12.538,17.145 12.737,16.953 C12.974,16.725 13.216,16.495 13.462,16.262 C16.401,13.475 19.439,10.593 17.775,6.591 C16.819,4.293 14.498,2.749 12,2.749 L12,2.75 C9.502,2.75 7.182,4.294 6.227,6.592 Z M12,22.75 C8.75,22.75 3.25,22.119 3.25,19.754 C3.25,18.641 4.456,17.804 6.835,17.268 C7.239,17.177 7.64,17.431 7.732,17.835 C7.823,18.239 7.569,18.64 7.165,18.732 C5.445,19.12 4.858,19.587 4.759,19.755 C4.999,20.204 7.386,21.25 12.001,21.25 C16.616,21.25 19.002,20.204 19.243,19.755 C19.144,19.587 18.557,19.119 16.837,18.732 C16.433,18.641 16.179,18.24 16.27,17.835 C16.361,17.431 16.762,17.177 17.167,17.268 C19.546,17.804 20.752,18.64 20.752,19.754 C20.752,20.748 19.779,21.526 17.862,22.064 C16.287,22.506 14.206,22.75 12.002,22.75 Z M12,12.25 C10.208,12.25 8.75,10.792 8.75,9 C8.75,7.208 10.208,5.75 12,5.75 C13.792,5.75 15.25,7.208 15.25,9 C15.25,10.792 13.792,12.25 12,12.25 Z M12,7.25 C11.035,7.25 10.25,8.035 10.25,9 C10.25,9.965 11.035,10.75 12,10.75 C12.965,10.75 13.75,9.965 13.75,9 C13.75,8.035 12.965,7.25 12,7.25 Z" />
        </svg>
        @if (experienceForm.value.park && experienceForm.value.park !== '') {
          <p>{{ findParkNameById(experienceForm.value.park) }}</p>
        } @else {
          <p>Seleziona il Parco</p>
        }
      </div>
      @if (experienceForm.value.description !== '') {
        <p>{{experienceForm.value.description }}</p>
      } @else {
        <p>Condividi la tua esperienza</p>
      }
      @if (experienceForm.value.name !== '' || experienceForm.value.surname !== '') {
        <h4>{{ experienceForm.value.name }} {{ experienceForm.value.surname }}</h4>
      } @else {
        <h4>Inserisci il tuo Nome</h4>
      }
    </figcaption>
  </figure>
</section>

<app-footer-component></app-footer-component>
